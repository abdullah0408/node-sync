#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

# ANSI color codes for terminal
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${YELLOW}⚡🚀 Checking your code before commit... ⚡🚀${NC}"

# Function to run a command and exit if it fails
run_check() {
  cmd=$1
  description=$2
  hint=$3

  echo -e "${BLUE}⏳ Running ${description}...${NC}"
  if ! $cmd; then
    echo -e "${RED}❌ ${description} failed!${NC}"
    if [ ! -z "$hint" ]; then
      echo -e "${YELLOW}💡 Hint: $hint${NC}"
    fi
    exit 1
  else
    echo -e "${GREEN}✅ ${description} passed!${NC}"
  fi
}

# Run checks
run_check "npm run check-format" "Prettier formatting check" "Run 'npm run format', stage changes, then commit again."
run_check "npm run lint" "ESLint check" "Fix ESLint issues above, stage changes, then commit again."
run_check "npm run check-types" "TypeScript type check" "Fix type errors above before committing."
run_check "npm run build" "Build check" "Fix build errors above before committing."

echo -e "${GREEN}🎉 All checks passed! Ready to commit! 🚀${NC}"